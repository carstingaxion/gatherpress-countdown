{"version":3,"file":"view.js","mappings":"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","sources":["webpack://block-gatherpress-countdown/./src/view.js"],"sourcesContent":["/**\n * Frontend countdown timer functionality.\n *\n * Handles real-time countdown/countup updates on the frontend.\n * Updates all countdown timer blocks on the page every second.\n *\n * @package GatherPressCountdown\n */\n\n( function() {\n\t'use strict';\n\n\t/**\n\t * Time unit conversion constants in seconds.\n\t *\n\t * @type {Object.<string, number>}\n\t */\n\tconst TIME_UNITS = {\n\t\tyears: 365.25 * 24 * 60 * 60,\n\t\tmonths: 30.44 * 24 * 60 * 60,\n\t\tweeks: 7 * 24 * 60 * 60,\n\t\tdays: 24 * 60 * 60,\n\t\thours: 60 * 60,\n\t\tminutes: 60,\n\t\tseconds: 1,\n\t};\n\n\t/**\n\t * Order of time segments from largest to smallest.\n\t *\n\t * @type {string[]}\n\t */\n\tconst SEGMENT_ORDER = ['years', 'months', 'weeks', 'days', 'hours', 'minutes', 'seconds'];\n\n\t/**\n\t * Calculate time difference with cascading based on selected segments.\n\t *\n\t * @param {string} targetDateTime - The target date/time in ISO format.\n\t * @param {Object} segments       - Object indicating which segments are shown.\n\t * @return {Object} Object containing calculated time values.\n\t */\n\tfunction calculateTimeDifference( targetDateTime, segments ) {\n\t\tconst now = new Date().getTime();\n\t\tconst target = new Date( targetDateTime ).getTime();\n\t\tconst difference = target - now;\n\t\tconst absDifference = Math.abs( difference );\n\n\t\tlet remainingSeconds = Math.floor( absDifference / 1000 );\n\t\tconst result = { total: difference };\n\n\t\t// Calculate each segment in order, subtracting from remainingSeconds\n\t\tSEGMENT_ORDER.forEach( function( segment ) {\n\t\t\tif ( segments[segment] ) {\n\t\t\t\tresult[segment] = Math.floor( remainingSeconds / TIME_UNITS[segment] );\n\t\t\t\tremainingSeconds -= result[segment] * TIME_UNITS[segment];\n\t\t\t} else {\n\t\t\t\tresult[segment] = 0;\n\t\t\t}\n\t\t} );\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Format number with leading zero.\n\t *\n\t * @param {number} num - The number to format.\n\t * @return {string} Formatted number string.\n\t */\n\tfunction formatNumber( num ) {\n\t\treturn num.toString().padStart( 2, '0' );\n\t}\n\n\t/**\n\t * Get segment configuration from timer element dataset.\n\t *\n\t * @param {HTMLElement} timerElement - The countdown timer DOM element.\n\t * @return {Object} Segment configuration object.\n\t */\n\tfunction getSegmentConfig( timerElement ) {\n\t\treturn {\n\t\t\tyears: timerElement.dataset.showYears === '1',\n\t\t\tmonths: timerElement.dataset.showMonths === '1',\n\t\t\tweeks: timerElement.dataset.showWeeks === '1',\n\t\t\tdays: timerElement.dataset.showDays === '1',\n\t\t\thours: timerElement.dataset.showHours === '1',\n\t\t\tminutes: timerElement.dataset.showMinutes === '1',\n\t\t\tseconds: timerElement.dataset.showSeconds === '1'\n\t\t};\n\t}\n\n\t/**\n\t * Get enabled segments in order.\n\t *\n\t * @param {Object} segmentConfig - Segment configuration object.\n\t * @return {string[]} Array of enabled segment names.\n\t */\n\tfunction getEnabledSegments( segmentConfig ) {\n\t\treturn SEGMENT_ORDER.filter( function( segment ) {\n\t\t\treturn segmentConfig[segment];\n\t\t} );\n\t}\n\n\t/**\n\t * Update a single countdown timer element.\n\t *\n\t * @param {HTMLElement} timerElement - The countdown timer DOM element.\n\t * @return {void}\n\t */\n\tfunction updateTimer( timerElement ) {\n\t\tconst targetDateTime = timerElement.dataset.target;\n\t\tif ( ! targetDateTime ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst segmentConfig = getSegmentConfig( timerElement );\n\t\tconst timeLeft = calculateTimeDifference( targetDateTime, segmentConfig );\n\t\tconst segmentElements = timerElement.querySelectorAll( '.gatherpress-countdown__segment' );\n\n\t\tif ( segmentElements.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst enabledSegments = getEnabledSegments( segmentConfig );\n\t\tconst values = enabledSegments.map( function( segment ) {\n\t\t\treturn timeLeft[segment];\n\t\t} );\n\t\t\n\t\t// Find the first non-zero segment from the start\n\t\tlet firstNonZeroIndex = -1;\n\t\tfor ( let i = 0; i < values.length; i++ ) {\n\t\t\tif ( values[ i ] > 0 ) {\n\t\t\t\tfirstNonZeroIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\tsegmentElements.forEach( function( segment, index ) {\n\t\t\tif ( index >= values.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tconst value = values[ index ];\n\t\t\tconst numberElement = segment.querySelector( '.gatherpress-countdown__number' );\n\t\t\t\n\t\t\tif ( numberElement ) {\n\t\t\t\tnumberElement.textContent = formatNumber( value );\n\t\t\t}\n\t\t\t\n\t\t\t// Only hide segments that come BEFORE the first non-zero segment\n\t\t\t// This ensures in-between zero values are never hidden\n\t\t\tif ( firstNonZeroIndex !== -1 && index < firstNonZeroIndex && value === 0 ) {\n\t\t\t\tsegment.style.display = 'none';\n\t\t\t} else {\n\t\t\t\tsegment.style.display = '';\n\t\t\t}\n\t\t} );\n\n\t\t// Update mode attribute if needed.\n\t\tconst newMode = timeLeft.total < 0 ? 'countup' : 'countdown';\n\t\tif ( timerElement.dataset.mode !== newMode ) {\n\t\t\ttimerElement.dataset.mode = newMode;\n\t\t}\n\t}\n\n\t/**\n\t * Initialize countdown timers on the page.\n\t *\n\t * Sets up interval to update all countdown timers every second.\n\t *\n\t * @return {void}\n\t */\n\tfunction initCountdownTimers() {\n\t\tconst timers = document.querySelectorAll( '.gatherpress-countdown' );\n\t\t\n\t\tif ( timers.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Initial update.\n\t\ttimers.forEach( updateTimer );\n\n\t\t// Update every second.\n\t\tsetInterval( function() {\n\t\t\ttimers.forEach( updateTimer );\n\t\t}, 1000 );\n\t}\n\n\t// Initialize when DOM is ready.\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initCountdownTimers );\n\t} else {\n\t\tinitCountdownTimers();\n\t}\n}() );"],"names":["TIME_UNITS","years","months","weeks","days","hours","minutes","seconds","SEGMENT_ORDER","calculateTimeDifference","targetDateTime","segments","now","Date","getTime","target","difference","absDifference","Math","abs","remainingSeconds","floor","result","total","forEach","segment","formatNumber","num","toString","padStart","getSegmentConfig","timerElement","dataset","showYears","showMonths","showWeeks","showDays","showHours","showMinutes","showSeconds","getEnabledSegments","segmentConfig","filter","updateTimer","timeLeft","segmentElements","querySelectorAll","length","enabledSegments","values","map","firstNonZeroIndex","i","index","value","numberElement","querySelector","textContent","style","display","newMode","mode","initCountdownTimers","timers","document","setInterval","readyState","addEventListener"],"ignoreList":[],"sourceRoot":""}